<!DOCTYPE html>
<html>

<head>
    <title>Anorak Search</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://unpkg.com/htmx.org@1.9.4/dist/htmx.min.js"></script>
    <script src="https://kit.fontawesome.com/48f6fc2f0a.js" crossorigin="anonymous" async></script>
</head>

<body>
    <div id="container">
        <form hx-post="/query/" hx-swap="innerHTML" hx-target="#mainContent" hx-trigger="submit">
            <div class="search">
                <input type="text" placeholder="search..." id="search_term" name="search_term" autofocus>
            </div>
        </form>
        <div id="mainContent"></div>
    </div>

    <script>
        (() => {
            const main = document.querySelector('#mainContent');
            if (!main) return;

            let expandedCell = null;
            document.body.addEventListener('click', (event) => {
                const target = event.target instanceof Element ? event.target : event.target?.parentElement;
                const cell = target?.closest('#mainContent td.name');
                if (!cell || !main.contains(cell)) return;

                if (expandedCell && expandedCell !== cell) {
                    expandedCell.classList.remove('expanded');
                }

                if (cell.classList.toggle('expanded')) {
                    expandedCell = cell;
                } else {
                    expandedCell = null;
                }
            });
        })();
    </script>
</body>

</html>
